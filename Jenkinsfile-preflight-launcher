// ECS builds on o03-cot, Azure builds on c12-cot
isAzure = env.JENKINS_URL.contains('c12-cot') as boolean

GITHUB_ORG_NAME = 'media-and-entertainment'
PROJECT_NAME = 'ecg-maya-usd'
EXTRA_PR_FOLDER = isAzure ? 'health' : ''
TOP_FOLDER = isAzure ? 'EMS/ECG' : 'ECP'
DISPATCH_POOL = isAzure ? 'aws-linux' : 'mayausd-preload-pool'

pipeline {
    agent {
        label "${DISPATCH_POOL}"
    }
    stages {
        stage('Triggering Preflight Update Submodule') {
            steps {
                sh 'env|sort'
                script {
                        build(
                            job: "${TOP_FOLDER}/${PROJECT_NAME}/${EXTRA_PR_FOLDER}/ecg-mayausd-preflight-update-submodule-master",
                            parameters: [
                                string(name:'DISABLE_MAIL_NOTIFICATIONS', value:'ON')
                            ],
                            wait: false,
                            propagate: false
                        )
                }
            }
        }
    }
}
